<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Jigsaw Love Puzzle</title>
  <style>
    body {
      background-color: #ffe6ec;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      color: #d6336c;
      margin-bottom: 10px;
    }

    #puzzle-board {
      position: relative;
      width: 300px;
      height: 300px;
      border: 4px dashed #d6336c;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      margin-bottom: 20px;
    }

    .drop-zone {
      width: 100px;
      height: 100px;
      border: 1px dashed transparent;
      position: relative;
    }

    #pieces {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      max-width: 320px;
    }

    .piece {
      width: 100px;
      height: 100px;
      background-image: url('us_puzzle.jpeg');
      background-size: 300px 300px;
      border-radius: 6px;
      cursor: grab;
    }

    .hidden {
      display: none;
    }

    #message {
      display: none;
      font-size: 1.5rem;
      color: #d6336c;
      animation: fadeIn 1s ease forwards;
    }

    button {
      margin-top: 15px;
      background-color: #ff99b7;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      background-color: #ff6b9c;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @media (max-width: 500px) {
      #puzzle-board, .piece {
        width: 240px;
        height: 240px;
      }

      .drop-zone, .piece {
        width: 80px;
        height: 80px;
      }

      .piece {
        background-size: 240px 240px;
      }
    }
  </style>
</head>
<body>
  <h1>üíñ Complete the Puzzle üíñ</h1>
  <div id="puzzle-board"></div>
  <div id="pieces"></div>
  <div id="message">You complete me ‚ù§Ô∏è</div>
  <button onclick="initPuzzle()">Restart</button>

  <script>
    const gridSize = 3;
    let correctCount = 0;

    function initPuzzle() {
      const board = document.getElementById('puzzle-board');
      const pieces = document.getElementById('pieces');
      const message = document.getElementById('message');
      board.innerHTML = '';
      pieces.innerHTML = '';
      message.style.display = 'none';
      correctCount = 0;

      const positions = [];

      for (let y = 0; y < gridSize; y++) {
        for (let x = 0; x < gridSize; x++) {
          const pos = { x, y };
          positions.push(pos);

          // Drop zone
          const dropZone = document.createElement('div');
          dropZone.classList.add('drop-zone');
          dropZone.dataset.x = x;
          dropZone.dataset.y = y;
          dropZone.addEventListener('dragover', e => e.preventDefault());
          dropZone.addEventListener('drop', handleDrop);
          board.appendChild(dropZone);
        }
      }

      // Shuffle and create pieces
      const shuffled = [...positions].sort(() => Math.random() - 0.5);
      shuffled.forEach((pos, i) => {
        const piece = document.createElement('div');
        piece.classList.add('piece');
        piece.setAttribute('draggable', 'true');
        piece.dataset.x = pos.x;
        piece.dataset.y = pos.y;
        piece.style.backgroundPosition = `-${pos.x * 100}px -${pos.y * 100}px`;

        piece.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', `${pos.x},${pos.y},${i}`);
          e.dataTransfer.effectAllowed = 'move';
          e.target.classList.add('dragging');
        });

        piece.addEventListener('dragend', (e) => {
          e.target.classList.remove('dragging');
        });

        pieces.appendChild(piece);
      });
    }

    function handleDrop(e) {
      const [pieceX, pieceY, pieceIndex] = e.dataTransfer.getData('text/plain').split(',').map(Number);
      const dropX = +this.dataset.x;
      const dropY = +this.dataset.y;

      const draggedPiece = document.querySelector(`.piece[data-x="${pieceX}"][data-y="${pieceY}"]`);
      if (!draggedPiece) return;

      if (pieceX === dropX && pieceY === dropY) {
        this.appendChild(draggedPiece);
        draggedPiece.style.position = 'absolute';
        draggedPiece.style.left = '0';
        draggedPiece.style.top = '0';
        draggedPiece.setAttribute('draggable', 'false');
        draggedPiece.style.cursor = 'default';

        correctCount++;
        if (correctCount === gridSize * gridSize) {
          document.getElementById('message').style.display = 'block';
          // Optional: play sound or confetti here
        }
      }
    }

    window.onload = initPuzzle;
  </script>
</body>
</html>
